@model LiqunManagement.ViewModels.FormViewModels
@{
    ViewBag.Title = "表單四期";
    Layout = "~/Views/Shared/smartadmin_Layout.cshtml";


    //表單編號
    var FormID = Model.FormID != null ? Model.FormID : "";
    var ErrorMessage = ViewBag.ErrorMessage != null ? ViewBag.ErrorMessage : "";

    //4期租客資格備註
    var qualifyRadio = Model.secretaryviewmodel != null ? Model.secretaryviewmodel.qualifyRadio.ToString() : "";
    //段
    var excerpt = Model.secretaryviewmodel != null ? Model.secretaryviewmodel.excerpt : "";
    //小段
    var excerptShort = Model.secretaryviewmodel != null ? Model.secretaryviewmodel.excerptShort : "";
    //建號
    var buildNo = Model.secretaryviewmodel != null ? Model.secretaryviewmodel.buildNo : "";
    //地號
    var placeNo = Model.secretaryviewmodel != null ? Model.secretaryviewmodel.placeNo : "";
    //建築完成日
    var buildCreateDate = Model.secretaryviewmodel != null ? Model.secretaryviewmodel.buildCreateDate : "";
    //層數
    var floorAmount = Model.secretaryviewmodel != null ? Model.secretaryviewmodel.floorAmount : 0;
    //層次
    var floorNo = Model.secretaryviewmodel != null ? Model.secretaryviewmodel.floorNo : 0;
    //平方公尺
    var squareAmount = Model.secretaryviewmodel != null ? Model.secretaryviewmodel.squareAmount.ToString() : "";
    //坪數
    var pinAmount = Model.secretaryviewmodel != null ? Model.secretaryviewmodel.pinAmount.ToString() : "";
    //市場租金
    var rentMarket = Model.secretaryviewmodel != null ? Model.secretaryviewmodel.rentMarket : 0;
    //待租租金
    var rentAgent = Model.secretaryviewmodel != null ? Model.secretaryviewmodel.rentAgent : 0;
    //帶租押金
    var depositAgent = Model.secretaryviewmodel != null ? Model.secretaryviewmodel.depositAgent : 0;
    //Memo
    var Memo = Model.secretaryviewmodel != null ? Model.secretaryviewmodel.Memo : "";

    //是否公證
    var notarizationFeeRadio = Model.secretaryviewmodel != null ? Model.secretaryviewmodel.notarizationFeeRadio : -1;

}
<style>
    .padding-top-ten {
        padding-top: 10px !important;
    }

    .panel .panel-toolbar {
        display: none;
    }

    .panel.panel-locked:not(.panel-fullscreen) .panel-hdr h2:before {
        display: none;
    }

    .form-label {
        font-weight: 600 !important;
    }
</style>
@*select2*@
@*<link href="~/Content/select2/css/select2.min.css" rel="stylesheet" />*@
<link href="~/Content/smartadmin-package-4.5.1/smartadmin-html-full/dist/css/formplugins/select2/select2.bundle.css" rel="stylesheet" />
@*datepicker*@
<link href="~/Content/smartadmin-package-4.5.1/smartadmin-html-full/dist/css/formplugins/bootstrap-datepicker/bootstrap-datepicker.css" rel="stylesheet" />
@*sweetalert2*@
<link href="~/Content/sweetalert2/sweetalert2.min.css" rel="stylesheet" />

<main id="js-page-content" role="main" class="page-content">
    <ol class="breadcrumb page-breadcrumb">
        <li class="breadcrumb-item">
            <a href="javascript:void(0);">後臺管理系統</a>
        </li>
        <li class="breadcrumb-item">表單填寫</li>
        <li class="breadcrumb-item">四期</li>
        <li class="breadcrumb-item active">秘書</li>
        <li class="position-absolute pos-top pos-right d-none d-sm-block">
            <span class="js-get-date"></span>
        </li>
    </ol>
    <div class="subheader">
        <h1 class="subheader-title">
            <i class="subheader-icon fal fa-edit"></i>
            <span class="font-weight-bold" style="padding-top:5px;">秘書填寫</span>
            <small>

            </small>
        </h1>
    </div>
    <div class="row">
        <div class="col-xl-12">
            <div id="panel-1" class="panel panel-locked">
                <div class="panel-hdr">
                    <h2>
                        秘書填寫
                    </h2>
                </div>
                <div class="panel-container show">
                    <div class="panel-content">

                        @using (Html.BeginForm("Secretary", "Form", FormMethod.Post, new { @class = "needs-validation", @enctype = "multipart/form-data", @novalidate = "" }))
                        {
                            @*表單編號*@
                            <input type="text" value="@FormID" name="FormID" hidden />
                            <!--4期租客資格備註-->
                            <div class="panel-tag">
                                4期租客資格備註
                            </div>
                            <div class="form-group">
                                <div class="frame-wrap padding-top-ten">
                                    <div class="custom-control custom-radio custom-radio-rounded">
                                        <input type="radio" class="custom-control-input" id="qualifyRadio_0" name="qualifyRadio" value="0" required>
                                        <label class="custom-control-label" for="qualifyRadio_0">
                                            整合戶 符合社宅、符合300億 (可領補助)
                                        </label>
                                    </div>
                                    <div class="custom-control custom-radio custom-radio-rounded">
                                        <input type="radio" class="custom-control-input" id="qualifyRadio_1" name="qualifyRadio" value="1" required>
                                        <label class="custom-control-label" for="qualifyRadio_1">
                                            換期戶 原有案件換新期數
                                        </label>
                                    </div>
                                    <div class="custom-control custom-radio custom-radio-rounded">
                                        <input type="radio" class="custom-control-input" id="qualifyRadio_2" name="qualifyRadio" value="2" required>
                                        <label class="custom-control-label" for="qualifyRadio_2">
                                            轉軌2 既有租約 (原為300億物件及租客)
                                        </label>
                                    </div>
                                    <div class="custom-control custom-radio custom-radio-rounded">
                                        <input type="radio" class="custom-control-input" id="qualifyRadio_3" name="qualifyRadio" value="3" required>
                                        <label class="custom-control-label" for="qualifyRadio_3">
                                            轉軌4   300億房客舊租屋轉新租屋
                                        </label>
                                    </div>
                                    <div class="custom-control custom-radio custom-radio-rounded">
                                        <input type="radio" class="custom-control-input" id="qualifyRadio_4" name="qualifyRadio" value="4" required>
                                        <label class="custom-control-label" for="qualifyRadio_4">
                                            一般戶 符合社宅、不符合300億(無補助)
                                        </label>
                                    </div>
                                    <div class="custom-control custom-radio custom-radio-rounded">
                                        <input type="radio" class="custom-control-input" id="qualifyRadio_5" name="qualifyRadio" value="5" required>
                                        <label class="custom-control-label" for="qualifyRadio_5">
                                            轉期戶 符合社宅、不符合300億 2、3期弱勢戶舊房客 (可領補助，但無加碼)
                                        </label>
                                    </div>
                                    <div class="custom-control custom-radio custom-radio-rounded">
                                        <input type="radio" class="custom-control-input" id="qualifyRadio_6" name="qualifyRadio" value="6" required>
                                        <label class="custom-control-label" for="qualifyRadio_6">
                                            換居戶 符合換居身分 (可領補助，但無加碼)
                                        </label>
                                        <div class="invalid-feedback">
                                            請選擇資格備註
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--地號-->
                            <div class="form-group">
                                <label class="form-label">
                                    段 & 小段
                                    <span class="text-danger">*</span>
                                </label>
                                <div class="col-md-10 col-lg-8 col-xl-6 ">
                                    <div class="input-group input-group-multi-transition w-100">
                                        <input type="text" class="form-control" name="excerpt" placeholder="請填寫段" value="@excerpt" required pattern="[A-Za-z0-9\u4e00-\u9fa5]+">
                                        <div class="input-group-append">
                                            <span class="input-group-text">段</span>
                                        </div>
                                        <input type="text" class="form-control" name="excerptShort" placeholder="請填寫小段" value="@excerptShort" pattern="[A-Za-z0-9\u4e00-\u9fa5]+">
                                        <div class="input-group-append">
                                            <span class="input-group-text">小段</span>
                                        </div>
                                        <div class="invalid-feedback">
                                            請輸入段/小段
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--建號-->
                            <div class="form-group">
                                <label class="form-label">
                                    建號:
                                    <span class="text-danger">*</span>
                                </label>
                                <div class="col-md-10 col-lg-8 col-xl-6 ">
                                    <div class="input-group input-group-multi-transition w-100">
                                        <div class="input-group-append">
                                            <span class="input-group-text">建號</span>
                                        </div>
                                        <input type="text" class="form-control" name="buildNo" placeholder="請輸入建號" value="@buildNo" required>
                                        <div class="invalid-feedback">
                                            請輸入建號
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--地號-->
                            <div class="form-group">
                                <label class="form-label">
                                    地號:
                                    <span class="text-danger">*</span>
                                </label>
                                <div class="col-12">
                                    <div class="input-group">
                                        <div class="input-group-append">
                                            <span class="input-group-text">地號</span>
                                        </div>
                                        <input type="text" class="form-control" name="placeNo" placeholder="請輸入地號" value="@placeNo" required>
                                        <div class="invalid-feedback">
                                            請填寫地號
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--建築完成日-->
                            <div class="form-group">
                                <label class="form-label" for="buildCreatedate">建築完成日</label>
                                <span class="text-danger">*</span>
                                <div class="input-group">
                                    <input type="text" class="form-control " placeholder="請選擇建築完成日" id="buildCreatedate" name="buildCreatedate">
                                    <div class="input-group-append">
                                        <span class="input-group-text fs-xl">
                                            <i class="fal fa-calendar-check"></i>
                                        </span>
                                    </div>
                                    <div class="invalid-feedback">
                                        請選擇建築完成日
                                    </div>
                                </div>
                            </div>
                            <!--層數/層次-->
                            <div class="form-group">
                                <label class="form-label" for="floorAmount">層數 & 層次</label>
                                <div class="col-md-10 col-lg-8 col-xl-6 ">
                                    <div class="input-group input-group-multi-transition w-100">
                                        <div class="input-group-append">
                                            <span class="input-group-text">層數</span>
                                        </div>
                                        <input type="text" class="form-control" id="floorAmount" name="floorAmount" value="@floorAmount" required>
                                        <div class="input-group-append">
                                            <span class="input-group-text">層次</span>
                                        </div>
                                        <input type="text" class="form-control" id="floorNo" name="floorNo" value="@floorNo">
                                        <div class="invalid-feedback">
                                            請選擇層數 & 層次
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--平方公尺-->
                            <div class="form-group">
                                <label class="form-label">
                                    平方公尺:
                                    <span class="text-danger">*</span>
                                </label>
                                <div class="col-md-10 col-lg-8 col-xl-6 ">
                                    <div class="input-group w-100">
                                        <input type="number" step="0.01" class="form-control" id="squareAmount" name="squareAmount" value="@squareAmount" required>
                                        <div class="input-group-append">
                                            <span class="input-group-text">平方公尺</span>
                                        </div>
                                        <div class="invalid-feedback">
                                            請輸入平方公尺
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--坪數-->
                            <div class="form-group">
                                <label class="form-label">
                                    坪數:
                                    <span class="text-danger">*</span>
                                </label>
                                <div class="col-md-10 col-lg-8 col-xl-6 ">
                                    <div class="input-group w-100">
                                        <input type="number" step="0.01" class="form-control" id="pinAmount" name="pinAmount" value="@pinAmount" readonly>
                                        <div class="input-group-append">
                                            <span class="input-group-text">坪</span>
                                        </div>
                                        <div class="invalid-feedback">
                                            請輸入坪數
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--公證費-->
                            <div class="form-group">
                                <label class="form-label">
                                    公證費用負擔:
                                    <span class="text-danger">*</span>
                                </label>
                                <div class="frame-wrap padding-top-ten">
                                    <div class="custom-control custom-radio custom-control-inline custom-radio-rounded">
                                        <input type="radio" class="custom-control-input" id="notarizationFeeRadio_0" name="notarizationFeeRadio" value="0" required disabled>
                                        <label class="custom-control-label" for="notarizationFeeRadio_0">無公證</label>
                                    </div>
                                    <div class="custom-control custom-radio custom-control-inline custom-radio-rounded">
                                        <input type="radio" class="custom-control-input" id="notarizationFeeRadio_1" name="notarizationFeeRadio" value="1" required @(notarizationFeeRadio == 0 ? "disabled" : "")>
                                        <label class="custom-control-label" for="notarizationFeeRadio_1">出租人負擔</label>
                                    </div>
                                    <div class="custom-control custom-radio custom-control-inline custom-radio-rounded">
                                        <input type="radio" class="custom-control-input" id="notarizationFeeRadio_2" name="notarizationFeeRadio" value="2" required @(notarizationFeeRadio == 0 ? "disabled" : "")>
                                        <label class="custom-control-label" for="notarizationFeeRadio_2">承租人負擔</label>
                                    </div>
                                    <div class="custom-control custom-radio custom-control-inline custom-radio-rounded">
                                        <input type="radio" class="custom-control-input" id="notarizationFeeRadio_3" name="notarizationFeeRadio" value="3" required @(notarizationFeeRadio == 0 ? "disabled" : "")>
                                        <label class="custom-control-label" for="notarizationFeeRadio_3">平均分擔</label>
                                    </div>
                                </div>
                            </div>
                            <!--市場租金/待租租金/待租押金-->
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <label class="form-label" for="basic-url">市場租金</label>
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text">$</span>
                                            </div>
                                            <input type="number" class="form-control" data-inputmask="'alias': 'currency', 'digits': 0" name="rentMarket" placeholder="0" value="@rentMarket" required>
                                            <div class="invalid-feedback">
                                                請填寫市場租金
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <label class="form-label" for="basic-url">待租租金</label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <input type="number" class="form-control" placeholder="0" data-inputmask="'alias': 'currency', 'digits': 0" name="rentAgent" value="@rentAgent" required>
                                        <div class="invalid-feedback">
                                            請填寫待租租金
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <label class="form-label" for="basic-url">待租押金</label>
                                    <div class="input-group">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text">$</span>
                                        </div>
                                        <input type="number" class="form-control" placeholder="0" data-inputmask="'alias': 'currency', 'digits': 0" name="depositAgent" value="@depositAgent" required>
                                        <div class="invalid-feedback">
                                            請填寫待租押金
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--備註欄-->
                            <div class="form-group">
                                <label class="form-label" for="example-textarea">備註</label>
                                <textarea class="form-control" id="momo" name="memo" rows="5" style="height: 122px;">@Memo</textarea>
                            </div>
                            <div class="panel-content border-faded border-left-0 border-right-0 border-bottom-0 d-flex flex-row align-items-center">
                                <div class="custom-control custom-checkbox">
                                    <input type="checkbox" class="custom-control-input" id="invalidCheck" required="">
                                    <label class="custom-control-label" for="invalidCheck">確認填寫完成 <span class="text-danger">*</span></label>
                                    <div class="invalid-feedback">
                                        您必須選擇此區塊以確認完成填寫
                                    </div>
                                </div>
                                <button class="btn btn-primary ml-auto waves-effect waves-themed" type="submit">送出</button>
                            </div>
                        }

                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

@section scripts
{
    @*select2*@
    @*<script src="~/Content/select2/js/select2.min.js"></script>*@
    <script src="~/Content/smartadmin-package-4.5.1/smartadmin-html-full/dist/js/formplugins/select2/select2.bundle.js"></script>
    @*sweetalert2*@
    <script src="~/Content/sweetalert2/sweetalert2.min.js"></script>
    @*datepicker*@
    <script src="~/Content/smartadmin-package-4.5.1/smartadmin-html-full/dist/js/formplugins/bootstrap-datepicker/bootstrap-datepicker.js"></script>
    @*inputmask*@
    <script src="~/Content/smartadmin-package-4.5.1/smartadmin-html-full/dist/js/formplugins/inputmask/inputmask.bundle.js"></script>

    <script type="text/javascript">
        //validation
        // Example starter JavaScript for disabling form submissions if there are invalid fields
        (function () {
            'use strict';
            window.addEventListener('load', function () {
                // Fetch all the forms we want to apply custom Bootstrap validation styles to
                var forms = document.getElementsByClassName('needs-validation');
                // Loop over them and prevent submission
                var validation = Array.prototype.filter.call(forms, function (form) {
                    form.addEventListener('submit', function (event) {
                        if (form.checkValidity() === false) {
                            event.preventDefault();
                            event.stopPropagation();
                        }
                        form.classList.add('was-validated');
                    }, false);
                });
            }, false);
        })();

        !function (a) {
            a.fn.datepicker.dates["zh-TW"] = {
                days: ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"],
                daysShort: ["週日", "週一", "週二", "週三", "週四", "週五", "週六"],
                daysMin: ["日", "一", "二", "三", "四", "五", "六"],
                months: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
                monthsShort: ["1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月"],
                today: "今天",
                monthsTitle: "月份",
                weekStart: 0,
                clear: "清除",
                format: "-mm-dd",
                titleFormat: "年MM月",
            };

            // 覆蓋原本的日期格式化函式，讓日期選擇器上的年份顯示為民國年
            a.fn.datepicker.DPGlobal.formatDate = function (date, format, language) {
                var year = date.getFullYear() - 1911; // 將年份減去1911，轉換為民國年
                var month = date.getMonth() + 1;
                var day = date.getDate();
                return year + format.replace(/mm/i, (month < 10 ? "0" : "") + month).replace(/dd/i, (day < 10 ? "0" : "") + day);
            };

        }(jQuery);

        $(function () {
            //ErrorMessage
            if ('@ErrorMessage' !== '') {
                alert("存取資料錯誤，請重新選單，若問題未解決請回報系統管理員。錯誤訊息:" + '@ErrorMessage');
            }

            //inputmask
            $(":input").inputmask();

            //------------------
            // 計算平方公尺  *
            //------------------
            const originalInput = document.getElementById('squareAmount');
            const resultInput = document.getElementById('pinAmount');

            originalInput.addEventListener('input', () => {
                const originalValue = parseFloat(originalInput.value);

                const calculatedResult = originalValue * 0.3025;
                // 将计算结果写入目标输入字段
                resultInput.value = calculatedResult.toFixed(2);

            });
            //Check&Radio
            $('#defaultIndeterminate').prop('indeterminate', true)
            $('#notarizationRadio').prop('indeterminate', true)

            var formid = '@FormID';
            if (formid !== '') {
                 //4期租客資格備註
                var qualifyRadio = '@qualifyRadio';
                if (qualifyRadio !== '') {
                    $('input[name="qualifyRadio"][value="' + qualifyRadio + '"]').prop('checked', true).trigger('change');
                }
                //建築完成日
                var buildCreateDate = new Date('@buildCreateDate');
                $('#buildCreatedate').datepicker("setDate", buildCreateDate);
                //是否公證
                var notarizationFeeRadio = '@notarizationFeeRadio';
                if (notarizationFeeRadio !== -1) {
                    $('input[name="notarizationFeeRadio"][value="' + notarizationFeeRadio + '"]').prop('checked', true).trigger('change');
                    //if (notarizationFeeRadio == 1) {
                    //    $('input[name="notarizationFeeRadio"]').prop('readonly', true);
                    //}
                }
            }
        });

        //function SubmitForm() {
        //    Swal.fire({
        //        title: '確定送出?',
        //        text: "確認資料皆填寫正確!",
        //        icon: 'warning',
        //        showCancelButton: true,
        //        confirmButtonColor: '#3085d6',
        //        cancelButtonColor: '#d33',
        //        confirmButtonText: '確認',
        //        cancelButtonText: '取消',
        //    }).then((result) => {
        //        if (result.isConfirmed) {
        //            //提交上傳
        //            $('#jqobjectform').submit();
        //            Swal.fire({
        //                title: '請稍後!',
        //                html: '系統完成上傳動作之前請勿關閉視窗',
        //                timerProgressBar: true,
        //                backdrop: false,
        //                didOpen: () => {
        //                    Swal.showLoading()
        //                }
        //            })
        //        }
        //    })
        //}

        //datepicker
        var controls = {
            leftArrow: '<i class="fal fa-angle-left" style="font-size: 1.25rem"></i>',
            rightArrow: '<i class="fal fa-angle-right" style="font-size: 1.25rem"></i>'
        }
        $('#buildCreatedate').datepicker(
            {
                //format: 'yyyy-mm-dd',
                orientation: "請選擇建築完成日",
                todayHighlight: true,
                templates: controls,
                autoclose: true,//選擇日期後就會自動關閉
                language: 'zh-TW',//中文化

                onSelect: function () {
                    $(this).change();
                },
            });


    </script>
}