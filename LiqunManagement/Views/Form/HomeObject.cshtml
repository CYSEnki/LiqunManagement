
@{
    ViewBag.Title = "表單四期";
    Layout = "~/Views/Shared/smartadmin_Layout.cshtml";
}
<style>
    .padding-top-ten {
        padding-top: 10px !important;
    }

    .panel .panel-toolbar {
        display: none;
    }

    .panel.panel-locked:not(.panel-fullscreen) .panel-hdr h2:before {
        display: none;
    }

    .form-label {
        font-weight: 600 !important;
    }
</style>
@*select2*@
@*<link href="~/Content/select2/css/select2.min.css" rel="stylesheet" />*@
<link href="~/Content/smartadmin-package-4.5.1/smartadmin-html-full/dist/css/formplugins/select2/select2.bundle.css" rel="stylesheet" />
@*datepicker*@
<link href="~/Content/smartadmin-package-4.5.1/smartadmin-html-full/dist/css/formplugins/bootstrap-datepicker/bootstrap-datepicker.css" rel="stylesheet" />
@*sweetalert2*@
<link href="~/Content/sweetalert2/sweetalert2.min.css" rel="stylesheet" />

<main id="js-page-content" role="main" class="page-content">
    <ol class="breadcrumb page-breadcrumb">
        <li class="breadcrumb-item">
            <a href="javascript:void(0);">後臺管理系統</a>
        </li>
        <li class="breadcrumb-item">填寫表單</li>
        <li class="breadcrumb-item">四期</li>
        <li class="breadcrumb-item active">物件資料</li>
        <li class="position-absolute pos-top pos-right d-none d-sm-block">
            <span class="js-get-date"></span>
        </li>
    </ol>
    <div class="subheader">
        <h1 class="subheader-title">
            <i class="subheader-icon fal fa-edit"></i>
            <span class="font-weight-bold" style="padding-top:5px;">物件資料</span>
            <small>

            </small>
        </h1>
    </div>
    <div class="row">
        <div class="col-xl-12">
            <div id="panel-1" class="panel panel-locked">
                <div class="panel-hdr">
                    <h2>
                        物件資料
                    </h2>
                </div>
                <div class="panel-container show">
                    <div class="panel-content">
                        @using (Html.BeginForm("HomeObject", "Form", FormMethod.Post, new { @class = "needs-validation was-validated", @id = "jqobjectform", @novalidate = "" }))

                        {
                            <div class="form-group">
                                <label class="form-label">
                                    是否為公證:
                                    <span class="text-danger">*</span>
                                </label>
                                <div class="frame-wrap padding-top-ten">
                                    <div class="custom-control custom-radio custom-control-inline custom-radio-rounded">
                                        <input type="radio" class="custom-control-input" id="Inline1Radio1_1" name="Inline1Radio1" value="yes" required="">
                                        <label class="custom-control-label" for="Inline1Radio1_1">是</label>
                                    </div>
                                    <div class="custom-control custom-radio custom-control-inline custom-radio-rounded">
                                        <input type="radio" class="custom-control-input" id="Inline1Radio1_2" name="Inline1Radio1" value="no" required="">
                                        <label class="custom-control-label" for="Inline1Radio1_2">否</label>

                                        <div class="invalid-feedback">
                                            請選擇是否為公證
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="example-date">簽約日</label>
                                <span class="text-danger">*</span>
                                <div class="input-group">
                                    <input type="text" class="form-control " placeholder="請選擇簽約日" id="datepicker-4-1" name="signdate" required>
                                    <div class="input-group-append">
                                        <span class="input-group-text fs-xl">
                                            <i class="fal fa-calendar-check"></i>
                                        </span>
                                    </div>
                                    <div class="invalid-feedback">
                                        請選擇簽約日
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">
                                    是否簽估價師/特色：
                                </label>
                                <span class="text-danger">*</span>
                                <div class="frame-wrap">
                                    <div class="custom-control custom-radio custom-control-inline custom-radio-rounded">
                                        <input type="radio" class="custom-control-input" id="Inline1Radio2_1" name="Inline1Radio2" value="yes" required>
                                        <label class="custom-control-label" for="Inline1Radio2_1">是</label>
                                    </div>
                                    <div class="custom-control custom-radio custom-control-inline custom-radio-rounded">
                                        <input type="radio" class="custom-control-input" id="Inline1Radio2_2" name="Inline1Radio2" value="no" required>
                                        <label class="custom-control-label" for="Inline1Radio2_2">否</label>
                                    </div>
                                    <div class="invalid-feedback">
                                        請選擇是否簽估價師
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="jqSpecialtext">特色</label>
                                <input type="text" id="jqSpecialtext" name="Specialtext" class="form-control">
                            </div>
                            @*物件地址*@
                            <div class="form-group">
                                <label class="form-label">物件地址</label>
                                <span class="text-danger">*</span>
                                <div class="row">
                                    <div class="col-lg-4 pt-3">
                                        <select class="custom-select form-control select2_city" name="cityselect" required>
                                            <option value="" selected=""></option>
                                        </select>
                                        <div class="invalid-feedback">
                                            請選擇縣/市
                                        </div>
                                    </div>
                                    <div class="col-lg-4 pt-3">
                                        <select class="custom-select form-control select2_district" name="district" required>
                                            <option value="" selected=""></option>
                                        </select>
                                        <div class="invalid-feedback">
                                            請選擇鄉/鎮/市/區
                                        </div>
                                    </div>
                                    <div class="col-lg-4 pt-3">
                                        <select class="custom-select form-control select2_road" name="road" required>
                                            <option value="" selected=""></option>
                                        </select>
                                        <div class="invalid-feedback">
                                            請選擇街/路
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @*主要用途*@
                            <div class="form-group">
                                <label class="form-label">
                                    主要用途
                                </label>
                                <span class="text-danger">*</span>
                                <div class="row">
                                    <div class="col-12">
                                        <div class="frame-wrap padding-top-ten pl-2">
                                            <div class="custom-control custom-radio custom-radio-rounded">
                                                <input type="radio" class="custom-control-input" id="Inline1Radio3_1" name="Inline1Radio3" value="1" required>
                                                <label class="custom-control-label" for="Inline1Radio3_1">住家用</label>
                                            </div>
                                            <div class="custom-control custom-radio custom-radio-rounded">
                                                <input type="radio" class="custom-control-input" id="Inline1Radio3_2" name="Inline1Radio3" value="2" required>
                                                <label class="custom-control-label" for="Inline1Radio3_2">商業用</label>
                                            </div>
                                            <div class="custom-control custom-radio custom-radio-rounded">
                                                <input type="radio" class="custom-control-input" id="Inline1Radio3_3" name="Inline1Radio3" value="3" required>
                                                <label class="custom-control-label" for="Inline1Radio3_3">辦公室</label>
                                            </div>
                                            <div class="custom-control custom-radio custom-radio-rounded">
                                                <input type="radio" class="custom-control-input" id="Inline1Radio3_4" name="Inline1Radio3" value="4" required>
                                                <label class="custom-control-label" for="Inline1Radio3_4">一般事務所</label>
                                            </div>
                                            <div class="custom-control custom-radio custom-radio-rounded">
                                                <input type="radio" class="custom-control-input" id="Inline1Radio3_5" name="Inline1Radio3" value="5" required>
                                                <label class="custom-control-label" for="Inline1Radio3_5">其他:</label>
                                            </div>
                                            <input type="text" id="elsemainuse" class="form-control mt-2" placeholder="請填寫其他選項" name="Inline1Radio3else" disabled>
                                            <div class="invalid-feedback">
                                                請選擇主要用途
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-primary ml-auto waves-effect waves-themed" type="submit">送出表單</button>
                        }

                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

@section scripts
{
    @*select2*@
    @*<script src="~/Content/select2/js/select2.min.js"></script>*@
    <script src="~/Content/smartadmin-package-4.5.1/smartadmin-html-full/dist/js/formplugins/select2/select2.bundle.js"></script>
    @*sweetalert2*@
    <script src="~/Content/sweetalert2/sweetalert2.min.js"></script>
    <script src="~/Content/smartadmin-package-4.5.1/smartadmin-html-full/dist/js/formplugins/bootstrap-datepicker/bootstrap-datepicker.js"></script>
    <script type="text/javascript">

        $(function () {
        //validation
        // Example starter JavaScript for disabling form submissions if there are invalid fields
            'use strict';
            window.addEventListener('load', function () {
                // Fetch all the forms we want to apply custom Bootstrap validation styles to
                var forms = document.getElementsByClassName('needs-validation');
                // Loop over them and prevent submission
                var validation = Array.prototype.filter.call(forms, function (form) {
                    form.addEventListener('submit', function (event) {
                        if (form.checkValidity() === false) {
                            event.preventDefault();
                            event.stopPropagation();
                        }
                        form.classList.add('was-validated');
                    }, false);
                });
            }, false);

            //------------------
            // 物件地址下拉選單  *
            //------------------
            var jsonCity = @Html.Raw(Json.Encode(ViewBag.citylist));
            var jsonArray = JSON.parse(jsonCity);

            for (var i = 0; i < jsonArray.length; i++) {
                jsonArray[i].id = jsonArray[i].id.replace(/\"/g, '');
                jsonArray[i].text = jsonArray[i].text.replace(/\"/g, '');
            }
         
            var data_city = jsonArray;
            $('.select2_city').select2({
                data: data_city,
                placeholder: '縣/市'
            });
            $('.select2_district').select2({
                //data: data_district,
                placeholder: '鄉/鎮/市/區',
            });
            $('.select2_road').select2({
                //data: data_road,
                placeholder: '街道',
            });
            //下拉選單更改事件

            //當下拉選單發生改變事件(change)，執行
            $('body').on('change', '.select2_city', function () {
                $('.select2_road').empty();
                $('.select2_road').select2({
                    placeholder: '街道',
                });
                var regioncode = $('.select2_city').val();
                $.ajax({
                    type: "POST",
                    data: { regioncode: regioncode },
                    url: '@Url.Content("~/Form/DDLRegion/")',
                    dataType: 'json'
                }).done(function (dataresult) {
                    var jsonArray = JSON.parse(dataresult);
                        for (var i = 0; i < jsonArray.length; i++) {
                            jsonArray[i].id = jsonArray[i].id.replace(/\"/g, '');
                            jsonArray[i].text = jsonArray[i].text.replace(/\"/g, '');
                        }
                    var data_district = jsonArray;
                    $('.select2_district').empty();
                    var init_data = [
                        {
                            id: '',
                            text: '鄉/鎮/市/區'
                        },
                    ];
                    $('.select2_district').select2({
                        data: init_data,
                    });
                    $('.select2_district').select2({
                        data: data_district,
                        placeholder: {
                            id: '',
                            text: '鄉/鎮/市/區'
                        }
                    });
                });
            });
            $('body').on('change', '.select2_district', function () {
                var regioncode = $('.select2_district').val();
                $.ajax({
                    type: "POST",
                    data: { regioncode: regioncode },
                    url: '@Url.Content("~/Form/DDLRegion/")',
                    dataType: 'json'
                }).done(function (dataresult) {
                    var jsonArray = JSON.parse(dataresult);
                        for (var i = 0; i < jsonArray.length; i++) {
                            jsonArray[i].id = jsonArray[i].id.replace(/\"/g, '');
                            jsonArray[i].text = jsonArray[i].text.replace(/\"/g, '');
                        }
                    var data_road = jsonArray;
                    $('.select2_road').empty();
                    var init_data = [
                        {
                            id: '',
                            text: '街道'
                        },
                    ];
                    $('.select2_road').select2({
                        data: init_data,
                    });
                    $('.select2_road').select2({
                        data: data_road,
                        placeholder: {
                            id: '',
                            text: '街道'
                        }
                    });
                });
            });




            var example_gridsize = $("#example-gridsize");

            $("#gridrange").on("input change", function () {
                //do something
                example_gridsize.attr("placeholder", ".col-" + $(this).val());
                example_gridsize.parent().removeClass().addClass("col-" + $(this).val())
                console.log("col-" + $(this).val());
            });

            //Check&Radio
            $('#defaultIndeterminate').prop('indeterminate', true)
            $('#Inline1Radio1').prop('indeterminate', true)

            //var toggleCheckbox = function () {
            //    $('#js-checkbox-toggle').toggleText('Change to CIRCLE', 'Change back to default');
            //    $('.frame-wrap .custom-checkbox').toggleClass('custom-checkbox-circle');
            //}

            var toggleRadio = function () {
                $('#js-radio-toggle').toggleText('Change to ROUNDED', 'Change back to default');
                $('.frame-wrap .custom-radio').toggleClass('custom-radio-rounded');
            }

            //radio監聽事件
            //主要用途 : Inline1Radio3
            $(document).ready(function () {
                $('input[name="Inline1Radio3"]').change(function () {
                    // 獲取被點選的 radio 按鈕的值
                    var selectedValue = $(this).val();
                    $('input[name="Inline1Radio3"]').each(function () {
                        var radioId = $(this).attr('id');
                        // 檢查是否被點選
                        if ($(this).is(':checked')) {
                            // 根據不同的 id 做相應的處理
                            if (radioId === 'Inline1Radio3_1') {
                                //住宅用; 不用上傳稅單
                                var fileInput = document.getElementById('taxFile');
                                var filelable = document.getElementById('taxFileLable');
                                fileInput.value = '';
                                filelable.innerHTML = '';
                                $('#taxFile').prop('required', false);
                                $('#taxFile').prop('disabled', true);
                                $('#taxFile').prop('readonly', true);
                                //其他
                                $('#elsemainuse').prop('required', false);
                                $('#elsemainuse').prop('disabled', true);
                                $('#elsemainuse').prop('readonly', true);

                            } else if (radioId === 'Inline1Radio3_5') {
                                //其他; 要填寫欄位
                                $('#taxFile').prop('required', true);
                                $('#taxFile').prop('disabled', false);
                                $('#taxFile').prop('readonly', false);
                                $('#elsemainuse').prop('required', true);
                                $('#elsemainuse').prop('disabled', false);
                                $('#elsemainuse').prop('readonly', false);

                            } else {
                                $('#taxFile').prop('required', true);
                                $('#taxFile').prop('disabled', false);
                                $('#taxFile').prop('readonly', false);
                                $('#elsemainuse').prop('required', false);
                                $('#elsemainuse').prop('disabled', true);
                                $('#elsemainuse').prop('readonly', true);
                                $('#elsemainuse').innerHTML = '';
                            }
                        }
                    })
                });
            });
        });

        function SubmitForm() {
            Swal.fire({
                title: '確定送出?',
                text: "確認資料皆填寫正確!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: '確認',
                cancelButtonText: '取消',
            }).then((result) => {
                if (result.isConfirmed) {
                    //提交上傳
                    $('#jqobjectform').submit();
                    Swal.fire({
                        title: '請稍後!',
                        html: '系統完成上傳動作之前請勿關閉視窗',
                        timerProgressBar: true,
                        backdrop: false,
                        didOpen: () => {
                            Swal.showLoading()
                        }
                    })
                }
            })
        }

        //datepicker
        var controls = {
            leftArrow: '<i class="fal fa-angle-left" style="font-size: 1.25rem"></i>',
            rightArrow: '<i class="fal fa-angle-right" style="font-size: 1.25rem"></i>'
        }
        $('#datepicker-4-1').datepicker(
            {
                format: 'yyyy-mm-dd',
                orientation: "請選擇簽約日",
                todayHighlight: true,
                templates: controls
            });


    </script>
}